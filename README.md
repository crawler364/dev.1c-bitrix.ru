# Парсер курсов Bitrix

Автономный парсер для скачивания курсов с сайта dev.1c-bitrix.ru в формате Markdown.

## Описание

Этот инструмент позволяет автоматически скачивать материалы курсов с платформы обучения 1C-Bitrix. Парсер извлекает содержимое из блока `courses-right-side`, сохраняя только релевантную информацию курса в удобном формате Markdown для последующего изучения.

## Возможности

- **Автономная работа**: Не требует внешних зависимостей, использует только стандартные библиотеки Python
- **Формат Markdown**: Сохранение контента в удобном для чтения формате MD
- **Организованная структура**: Файлы сохраняются в отдельные папки для каждого курса
- **Гибкие настройки**: Возможность ограничить количество скачиваемых страниц
- **Настройка таймаута**: Контроль задержки между запросами для вежливого скачивания
- **Метаданные**: Автоматическое извлечение и сохранение информации о курсе
- **Устойчивость к ошибкам**: Корректная обработка сетевых ошибок и недоступных страниц

## Установка

### Требования

- Python 3.6+
- Интернет-соединение

### Подготовка

Никаких дополнительных зависимостей не требуется. Все необходимые модули входят в стандартную библиотеку Python.

## Использование

Запуск осуществляется через shell-скрипт `run_parser.sh`:

### Базовое использование

```bash
# Скачать весь курс (без ограничений)
./run_parser.sh

# Скачать только первые 5 страниц
./run_parser.sh 5

# Скачать 10 страниц с таймаутом 2 секунды между запросами
./run_parser.sh 10 -t 2.0
```

### Расширенные опции

```bash
# Указать URL курса
./run_parser.sh -u "https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=50&INDEX=Y"

# Указать выходную директорию
./run_parser.sh -o ./my_courses

# Ограничить количество страниц
./run_parser.sh -l 20

# Настроить таймаут между запросами
./run_parser.sh -t 1.5

# Комбинирование опций
./run_parser.sh -l 15 -t 2.0 -o ./course_data
```

### Параметры командной строки

| Параметр | Описание | Значение по умолчанию |
|----------|----------|----------------------|
| `N` (позиционный) | Ограничение количества страниц | Без ограничений |
| `-u, --url` | URL курса для парсинга | course_43 |
| `-o, --output` | Директория для сохранения файлов | `./data` |
| `-l, --limit` | Максимальное количество страниц | Без ограничений |
| `-t, --timeout` | Таймаут между запросами (секунды) | `0.5` |
| `-h, --help` | Показать справку | - |

## Структура выходных файлов

После выполнения создается следующая структура:

```
data/
└── course_43/                           # Папка курса
    ├── course_info.json                 # Общая информация о курсе
    ├── course_43_Разработчик.md         # Главная страница курса
    ├── course_43_lesson_2560_Урок.md    # Страницы уроков
    ├── course_43_lesson_2561_Урок.md
    └── ...
```

### Формат файлов

- **`.md`** - Содержимое в формате Markdown с метаданными
- **`course_info.json`** - Структурированная информация о курсе со списком всех уроков

### Содержимое MD файлов

Каждый Markdown файл содержит:
- Заголовок страницы
- Метаданные (URL, дата последнего изменения)
- Структурированное содержимое из блока `courses-right-side`
- Все ссылки преобразованы в жирный текст

## Примеры использования

### Пример 1: Быстрое ознакомление

```bash
# Скачать первые 3 страницы для предварительного просмотра
./run_parser.sh 3
```

### Пример 2: Полное скачивание с медленным соединением

```bash
# Увеличить таймаут для стабильности при медленном соединении
./run_parser.sh -t 3.0
```

### Пример 3: Скачивание конкретного курса

```bash
# Курс администратора
./run_parser.sh -u "https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=85&INDEX=Y" -o ./admin_course
```

### Пример 4: Пакетное скачивание

```bash
# Курс разработчика (ограничено 50 страницами)
./run_parser.sh -l 50 -o ./developer_course

# Курс контент-менеджера  
./run_parser.sh -u "https://dev.1c-bitrix.ru/learning/course/index.php?COURSE_ID=34&INDEX=Y" -l 50 -o ./content_manager_course
```

## Особенности работы

### Вежливое скачивание

- Автоматические паузы между запросами (по умолчанию 0.5 секунды)
- Настраиваемый таймаут для адаптации к различным условиям сети
- Имитация браузера для стабильной работы

### Извлечение контента

- Фокус на блоке `courses-right-side` для получения релевантного содержимого
- Исключение навигационных элементов и служебной информации
- Сохранение структуры заголовков и форматирования

### Обработка ошибок

- Корректная обработка различных кодировок
- Пропуск недоступных страниц с информативными сообщениями
- Автоматическая декомпрессия gzip-сжатого контента

### Организация файлов

- Курсы сохраняются в отдельные папки (`course_43`, `course_85`, и т.д.)
- При невозможности определить ID курса используется папка `course`
- Понятные имена файлов на основе содержимого

## Устранение неполадок

### Скрипт не запускается

Убедитесь, что:
1. Вы находитесь в правильной директории проекта
2. Файл `run_parser.sh` имеет права на выполнение
3. Python 3 установлен и доступен

```bash
# Предоставить права на выполнение
chmod +x run_parser.sh

# Проверить версию Python
python3 --version
```

### Ошибки сети

- Увеличьте таймаут: `./run_parser.sh -t 2.0`
- Используйте ограничения для скачивания по частям: `./run_parser.sh -l 10`
- Проверьте интернет-соединение

### Пустые или неполные файлы

- Проверьте доступность URL курса
- Убедитесь, что страница курса загружается в браузере
- Возможно, изменилась структура сайта

## Правовая информация

Используйте парсер ответственно и в соответствии с условиями использования сайта dev.1c-bitrix.ru. Скачивайте только те материалы, к которым у вас есть законный доступ.
